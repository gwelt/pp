<!DOCTYPE html>
<html lang="de">
<head>
<meta name="viewport" content="width=device-width, initial-scale=1">
<!--
<link rel="icon" type="image/png" href="images/pp.png">
<link rel="apple-touch-icon" sizes="180x180" href="images/pp180.png">
-->
<meta name="theme-color" content="#000">
<meta name="Description" content="planning poker">
<title>planning poker</title>
<script>
var socket=undefined;

function loadScript(src, done) {
  var js = document.createElement('script');
  js.src = src;
  js.onload = function() {done(src+' executed')};
  document.head.appendChild(js);
}

setTimeout(function(){SocketIO()},0);
function SocketIO() {if (!socket) {loadScript('/pp/socket.io/socket.io.js', function() {
  socket=io.connect('', { 'path': '/pp/socket.io' });

  socket.on('reset', function () {
	document.getElementById('vote').value='';
	set();  
  });
  socket.on('about:you', function (json) {
  	console.log('about:you '+JSON.stringify(json));
    // accept default_name from server
  	if ((json.name!==undefined)&&(document.getElementById('name').value=='')) {document.getElementById('name').value=json.name};
  });
  socket.on('about:match', function (json) {
  	console.log('about:match '+JSON.stringify(json));
    document.getElementById('match').innerHTML=JSON.stringify(json);
  });
  socket.on('reconnect', function () {
    console.log('RECONNECTED!');
  	set();
});
  socket.on('disconnect', function (reason) {
  	console.log('DISCONNECTED! '+reason);
  });
})}};

function set() {
  socket.emit('set',document.getElementById('name').value,document.getElementById('vote').value);
}
function set_room_cards() {
  socket.emit('set_room_cards',document.getElementById('cards').value);
}
function reset() {
  socket.emit('reset');
}
function show() {
  socket.emit('show');
}
</script>

<style>
	* {box-sizing: border-box;}
	html, body, section, div, input {font-family: Monospace; font-size: 1.1rem;}
	body {border:0; padding:0; margin:0; color: #000;}
</style>

</head>
<body>

<div id="bigscreen" class="bigscreen">
	<input type="text" id="name" autocomplete="off"> <button onclick="set()">set name</button>
  <br><input type="text" id="vote" autocomplete="off"> <button onclick="set()">vote</button>
  <br><input type="text" id="cards" autocomplete="off"> <button onclick="set_room_cards()">set cards</button>
  <br><button onclick="show()">show</button> <button onclick="reset()">reset</button>
	<div id="match"></div>
</div>

</body>

</html>
