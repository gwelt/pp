<!DOCTYPE html>
<html lang="de">
<head>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="icon" type="image/png" href="images/pp.png">
<link rel="apple-touch-icon" sizes="180x180" href="images/pp180.png">
<meta name="theme-color" content="#000">
<meta name="Description" content="planning poker">
<title>planning poker</title>
<script>
var socket=undefined;

function loadScript(src, done) {
  var js = document.createElement('script');
  js.src = src;
  js.onload = function() {done(src+' executed')};
  document.head.appendChild(js);
}

setTimeout(function(){SocketIO()},0);
function SocketIO() {if (!socket) {loadScript('/socket.io/socket.io.js', function() {
  socket=io();
	//socket.emit('join',window.location.pathname.substring(1));
  socket.on('data', function (json) {
  	console.log(JSON.stringify(json));
  	//if (json.id!==undefined) {document.getElementById('current_id').innerHTML=json.id};
  	if (json.name!==undefined) {let n=document.getElementById('name'); if ((n.value!='')&&(n.value!==json.name)) {socket.emit('set_name',n.value)} else {n.value=json.name}};
  	//if (json.room!==undefined) {document.getElementById('current_room').innerHTML=json.room};
  	if (json.players!==undefined) {document.getElementById('current_players').innerHTML=JSON.stringify(json.players)};
  	//if (json.message!==undefined) {document.getElementById('message').innerHTML=json.message};
  });
  socket.on('disconnect', function (reason) {
  	//document.getElementById('message').innerHTML='DISCONNECTED! '+reason;
  });
})}};

</script>

<style>
	* {box-sizing: border-box;}
	html, body, section, div, input {font-family: Monospace; font-size: 1.1rem;}
	body {border:0; padding:0; margin:0; color: #000;}
</style>

</head>
<body>

<div id="bigscreen" class="bigscreen">
	<!--
	ID: <div id="current_id"></div>
	NAME: <div id="current_name"></div>
	ROOM: <div id="current_room"></div>
	PLAYERS: <div id="current_players"></div>
	MESSAGE: <div id="message"></div>
	<input type=text id=room autocomplete=off value="123"> &nbsp;
	<button onclick="socket.emit('join',document.getElementById('room').value)">join room</button>
	<button onclick="socket.emit('leave')">leave room</button>
	<br>
	-->
	<input type=text id=name autocomplete=off> <button onclick="socket.emit('set_name',document.getElementById('name').value)">set name</button>
	<br><input type=text id=vote autocomplete=off> <button onclick="socket.emit('set_vote',document.getElementById('vote').value)">vote</button>
	<button onclick="socket.emit('reset')">reset all votes</button>
	<div id="current_players"></div>
</div>

</body>

</html>
